<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Conflict Resolution</title>
    <link rel="stylesheet" type="text/css" href="../../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Conflict Resolution</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>
<p>The most popular usage of replication callback events is conflict resolution. When an object was changed in both replicating databases you must have a strategy to decide, which value must be final. In the simplest case one of the databases is made "dominant" and the changes in this database always override other changes. The following example demonstrates this behavior:</p>
<p><span name="cs_wiki_filter" csw_filters="java">&nbsp;</p>
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">EventsExample.java: <span class="fscMemberName">conflictResolutionExample</span></span></div><div class="fscCode"><pre ID="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> conflictResolutionExample() </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_48_2653_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Db4o.configure().generateUUIDs(ConfigScope.GLOBALLY);
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Db4o.configure().generateVersionNumbers(ConfigScope.GLOBALLY);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;">  Open databases</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    ObjectContainer desktop </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.openFile(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">desktop.db4o</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer handheld </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.openFile(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">handheld.db4o</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Scott Felton</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #000000;">200</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.set(pilot);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.commit();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Open_Text').style.display='inline';"/>    </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_407_496_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Clean the reference cache to make sure that objects in memory
</span><span style="color: #008080;">13</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    * won't interfere
</span><span style="color: #008080;">14</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    </span><span style="color: #008000;">*/</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.ext().refresh(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">, Integer.MAX_VALUE);
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Open_Text').style.display='inline';"/>    </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_561_853_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Replicate changes from handheld to desktop
</span><span style="color: #008080;">18</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * Note, that only objects replicated from one database to another will 
</span><span style="color: #008080;">19</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * be treated as the same. If you will create an object and save it to both
</span><span style="color: #008080;">20</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * databases, dRS will count them as 2 different objects with identical 
</span><span style="color: #008080;">21</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * fields.
</span><span style="color: #008080;">22</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>     </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ReplicationSession replication </span><span style="color: #000000;">=</span><span style="color: #000000;"> Replication.begin(handheld, desktop);
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectSet changedObjects </span><span style="color: #000000;">=</span><span style="color: #000000;"> replication.providerA().objectsChangedSinceLastReplication();
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (changedObjects.hasNext())
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      replication.replicate(changedObjects.next());
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    replication.commit();
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> change object on the handheld</span><span style="color: #008000;">
</span><span style="color: #008080;">30</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Pilot)handheld.query(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">).next();
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    pilot.setName(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">S.Felton</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.set(pilot);
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.commit();
</span><span style="color: #008080;">34</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">35</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;">  change object on the desktop</span><span style="color: #008000;">
</span><span style="color: #008080;">36</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Pilot)desktop.query(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">).next();
</span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    pilot.setName(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Scott</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">38</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    desktop.set(pilot);
</span><span style="color: #008080;">39</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    desktop.commit();
</span><span style="color: #008080;">40</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">41</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Open_Text').style.display='inline';"/>    </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1452_1666_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> The replication will face a conflict: Pilot object was changed on the 
</span><span style="color: #008080;">42</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    * handheld and on the desktop.
</span><span style="color: #008080;">43</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    * To resolve this conflict we will add an event handler, which makes
</span><span style="color: #008080;">44</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    * desktop changes dominating.
</span><span style="color: #008080;">45</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">46</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ReplicationEventListener listener;
</span><span style="color: #008080;">47</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Open_Text').style.display='inline';"/>    listener </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> ReplicationEventListener() </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1748_1954_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">48</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> onReplicate(ReplicationEvent event) </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1801_1950_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">49</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (event.isConflict()) </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_1831_1945_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">50</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          ObjectState chosenObjectState </span><span style="color: #000000;">=</span><span style="color: #000000;"> event.stateInProviderB();
</span><span style="color: #008080;">51</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          event.overrideWith(chosenObjectState);
</span><span style="color: #008080;">52</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">53</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">54</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">;
</span><span style="color: #008080;">55</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">56</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    replication </span><span style="color: #000000;">=</span><span style="color: #000000;"> Replication.begin(handheld, desktop, listener);
</span><span style="color: #008080;">57</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">58</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;">The state of the desktop after the replication should not change, as it dominates</span><span style="color: #008000;">
</span><span style="color: #008080;">59</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    changedObjects </span><span style="color: #000000;">=</span><span style="color: #000000;"> replication.providerA().objectsChangedSinceLastReplication();
</span><span style="color: #008080;">60</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (changedObjects.hasNext())
</span><span style="color: #008080;">61</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      replication.replicate(changedObjects.next());
</span><span style="color: #008080;">62</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">63</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;">Commit</span><span style="color: #008000;">
</span><span style="color: #008080;">64</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    replication.commit();
</span><span style="color: #008080;">65</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    replication.close();
</span><span style="color: #008080;">66</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">67</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Check what we've got on the desktop</span><span style="color: #008000;">
</span><span style="color: #008080;">68</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    ObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> desktop.query(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">69</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    System.out.println(result.size());
</span><span style="color: #008080;">70</span><span style="color: #000000;"><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Open_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Closed_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Closed_Text').style.display='inline';"/><img id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Closed_Text').style.display='none'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Open_Image').style.display='inline'; document.getElementById('..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (result.hasNext()) </span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="..DRSEventsJava.ZipsEventsExample.Java_EventsExample.Java_ConflictResolutionExample_445_75_2489_2532_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">71</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      System.out.println(result.next());
</span><span style="color: #008080;">72</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">73</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.close();
</span><span style="color: #008080;">74</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    desktop.close();
</span><span style="color: #008080;">75</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">76</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">handheld.db4o</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).delete();
</span><span style="color: #008080;">77</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">desktop.db4o</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).delete();
</span><span style="color: #008080;">78</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">79</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>&nbsp;</p>
<p></span>&nbsp;</p>
<p></p>
<p> <br>
</p>

</div>
    </div>
    <div id="footer">
					This revision (5) was last Modified 2007-07-09T19:39:39 by Tetyana.
				</div>
  </body>
</html>